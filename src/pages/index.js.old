import Link from 'next/link'
import { aboutRoute, postRouteProps } from '../routes'
import { Grid, Button, List, ListItem, ListItemAvatar, Avatar, ListItemText, Typography, Divider } from '@material-ui/core'
// This page has defined `getInitialProps` to do data fetching.
// Next.js will execute `getInitialProps`
// It will wait for the result of `getInitialProps`
// When the results comes back Next.js will render the page.
// Next.js will do this for every request that comes in.
//import fetch from 'isomorphic-unfetch'
import request from '../utils/request'
import { list_post_route } from '../api'
import React from 'react'
import useStyles from './index_styles'

const HomePage = ({ posts }) => {
    const classes = useStyles()
    return (
        <>
            <Grid item xs={12}>
                <Link href={aboutRoute()}>
                    <Button variant='contained' color='primary'>
                        About Page
                    </Button>
                </Link>
            </Grid>
            <Grid item xs={12}>
                <Link {...postRouteProps({ id: 1 })}>
                    <Button variant='contained' color='primary'>
                        Post 1 page
                    </Button>
                </Link>
            </Grid>
            <Grid item xs={6}>
                <List className={classes.root}>
                    {posts.map((post, key: number) => {
                        return (
                            <ListItem alignItems='flex-start' key={key}>
                                <ListItemAvatar>
                                    <Avatar />
                                </ListItemAvatar>
                                <ListItemText primary={post.title} secondary={post.body} />
                            </ListItem>
                        )
                    })}
                    {/* <Divider variant='inset' component='li' /> */}
                </List>
            </Grid>
        </>
    )
}
HomePage.getInitialProps = async () => {
    const posts = await request(list_post_route)
    //console.log('HOMEPAGE-response ===> ', { posts })
    return { posts }
}
export default HomePage
